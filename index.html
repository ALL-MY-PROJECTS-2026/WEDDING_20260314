<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    
    <!-- favicon -->

    <link rel="icon" href="images/favicon.png">

    <!-- Opengraph -->
    <meta property="og:type" content="website" /> 
    <meta property="og:site_name" content="SITENAME" />
    <meta property="og:title" content="민형 ❤ 유정 결혼합니다." />
    <meta property="og:description" content="2026년 3월 14일(토) 오후 03시 30분 웨딩그룹위더스 안양" />
    <meta property="og:image" content="https://github.com/ALL-MY-PROJECTS-2026/WEDDING_20260314/blob/main/images/01_section.jpg?raw=true" />
    <meta property="og:url" content="https://all-my-projects-2026.github.io/WEDDING_20260314/" />
    
    <!-- main.html preload (인트로 종료 후 전환) -->
    <link rel="preload" href="./main.html" as="document">

    <title>민형 ❤ 유정 결혼합니다.</title>

    <!-- Critical CSS 인라인 (인트로 화면 렌더링 최적화) -->
    <style>
      /* 기본 레이아웃 */
      *{box-sizing:border-box;position:relative;font-family:'Noto Sans KR',sans-serif;font-size:0.98rem;font-weight:400;color:rgb(58,58,58);}
      body{width:100vw;height:100vh;height:100svh;margin:0;padding:0;background-color:#ffffff;overflow:hidden;}
      /* 인트로 화면 - 첫 화면에 필수 */
      .intro-screen{position:fixed;top:0;left:0;right:0;bottom:0;width:100vw;height:100vh;height:100svh;background-image:url('./images/bg.png');background-repeat:repeat;background-color:#ffffff;display:flex;justify-content:center;align-items:center;z-index:9999;transition:opacity 0.3s ease-out;opacity:1;visibility:visible;pointer-events:auto;}
      .intro-content{position:relative;z-index:1;width:100%;max-width:100vw;padding:0 0.5rem;text-align:center;}
      .intro-svg-text{width:100%;display:flex;justify-content:center;align-items:center;position:relative;overflow:visible;}
      .intro-screen.intro-fade-out{opacity:0;pointer-events:none;}
      .intro-screen.intro-hidden{display:none!important;}
    </style>

    <!-- 폰트 preconnect 최적화 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://hangeul.pstatic.net">
    
    <!-- 나눔예쁜명경체 - 인트로 화면용 (지연 로드) -->
    <link rel="preload" href="https://hangeul.pstatic.net/hangeul_static/css/NanumYeBbeunMinGyeongCe.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://hangeul.pstatic.net/hangeul_static/css/NanumYeBbeunMinGyeongCe.css"></noscript>

    <!-- google font (지연 로드) -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Hi+Melody&family=Noto+Sans+KR&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Hi+Melody&family=Noto+Sans+KR&display=swap"></noscript>
    
    <!-- Critical CSS - 즉시 로드 (인트로 화면에 필수) -->
    <link rel="stylesheet" href="./css/00_Intro_Screen.css">

  </head>
  <body>
    <!-- 인트로 화면: 결혼식에 초대합니다 -->
    <div class="intro-screen" id="introScreen">
      <div class="intro-content">
        <div class="intro-svg-text" id="introSvgContainer">
          <!-- SVG가 JavaScript로 동적으로 로드됩니다 -->
        </div>
      </div>
    </div>

    <!-- 인트로 관련 스크립트 - 인라인화 -->
    <script>
/**
 * 인트로 화면 - 통합 스크립트
 * SVG Stroke Drawing 효과 및 타이밍 제어
 */
(function () {
    // 타이밍 상수
    const FADE_IN_DELAY = 300; // 텍스트 페이드인 딜레이 (CSS와 동일)
    const FADE_IN_DURATION = 1000; // 텍스트 페이드인 지속 시간 (CSS와 동일)
    const HOLD_DURATION = 0; // 텍스트 표시 후 대기 시간 (SVG draw 완료 후 바로 전환)
    
    // SVG Drawing 상수
    const DRAW_DURATION = 4000; // 그려지는 애니메이션 지속 시간 (4초)

    /**
     * 인트로 화면 페이드아웃 처리 및 main.html로 전환
     */
    function fadeOutIntro() {
        const introScreen = document.getElementById('introScreen');
        if (!introScreen) return;
        introScreen.classList.add('intro-fade-out');
        
        // 페이드아웃 시간을 줄여서 빠르게 전환 (300ms)
        setTimeout(function () {
            // main.html로 페이지 전환
            window.location.href = './main.html';
        }, 300);
    }

    /**
     * SVG path를 한 획씩 그려지는 애니메이션 처리
     */
    function setupStrokeDrawing(svgElement) {
        // loading_g 그룹 안의 path 찾기
        const loadingGroup = svgElement.querySelector('.loading_g');
        if (!loadingGroup) {
            // loading_g가 없으면 모든 stroke path 찾기
            const paths = svgElement.querySelectorAll('path[stroke]');
            if (paths.length === 0) {
                console.warn('SVG path를 찾을 수 없습니다.');
                return 0;
            }
            return animatePath(paths[0]);
        }
        
        // loading_g 안의 path 찾기
        const paths = loadingGroup.querySelectorAll('path[stroke]');
        if (paths.length === 0) {
            console.warn('SVG path를 찾을 수 없습니다.');
            return 0;
        }
        
        // 첫 번째 path를 한 획씩 그려지게 처리
        return animatePath(paths[0]);
    }
    
    /**
     * Path를 한 획씩 그려지는 애니메이션 적용
     */
    function animatePath(path) {
        const pathLength = path.getTotalLength();
        
        if (pathLength === 0) {
            console.warn('Path의 길이가 0입니다.');
            return 0;
        }
        
        // stroke-dasharray와 stroke-dashoffset 설정
        path.style.strokeDasharray = pathLength;
        path.style.strokeDashoffset = pathLength;
        path.style.strokeLinecap = 'round';
        path.style.strokeLinejoin = 'round';
        path.style.opacity = '1';
        
        // CSS 변수 설정 (CSS 애니메이션에서 사용)
        path.style.setProperty('--path-length', pathLength);
        
        // CSS 애니메이션으로 한 획씩 그려지게 처리
        path.style.animation = `intro-svg-draw ${DRAW_DURATION}ms ease-out 0ms forwards`;
        
        return DRAW_DURATION; // 전체 애니메이션 완료 시간
    }

    /**
     * SVG 파일을 로드하고 인라인으로 삽입
     * @returns {Promise<number>} SVG 그리기 애니메이션 완료 시간 (ms)
     */
    async function loadAndSetupSVG() {
        return new Promise(function(resolve) {
            const container = document.getElementById('introSvgContainer');
            if (!container) {
                resolve(0);
                return;
            }

            // file:// 프로토콜 체크 (CORS 문제 방지)
            const isFileProtocol = window.location.protocol === 'file:';
            
            // file:// 프로토콜에서는 fetch 대신 img 태그 사용
            if (isFileProtocol) {
                container.innerHTML = '<img src="./images/intro.svg" alt="결혼식에 초대합니다" class="intro-svg svg_handwritng">';
                // 이미지의 경우 즉시 완료로 처리
                resolve(0);
                return;
            }
            
            // SVG 파일을 fetch로 로드
            fetch('./images/intro.svg')
                .then(function(response) {
                    if (!response.ok) {
                        throw new Error('SVG 파일을 불러올 수 없습니다.');
                    }
                    return response.text();
                })
                .then(function(svgText) {
                    // SVG 텍스트를 DOM으로 변환
                    const parser = new DOMParser();
                    const svgDoc = parser.parseFromString(svgText, 'image/svg+xml');
                    const svgElement = svgDoc.querySelector('svg');
                    
                    if (!svgElement) {
                        throw new Error('SVG 요소를 찾을 수 없습니다.');
                    }

                    // SVG에 클래스 추가 및 스타일 설정
                    svgElement.classList.add('intro-svg', 'svg_handwritng');
                    svgElement.setAttribute('preserveAspectRatio', 'xMidYMid meet');
                    svgElement.setAttribute('aria-label', '결혼식에 초대합니다');
                    
                    // 컨테이너에 SVG 삽입
                    container.appendChild(svgElement);
                    
                    // SVG가 DOM에 삽입된 후 stroke drawing 설정
                    setTimeout(function() {
                        const animationDuration = setupStrokeDrawing(svgElement);
                        
                        // 애니메이션 완료를 감지하기 위해 animationend 이벤트 사용
                        if (animationDuration > 0) {
                            const path = svgElement.querySelector('path[stroke]') || 
                                        svgElement.querySelector('.loading_g path[stroke]');
                            if (path) {
                                // animationend 이벤트로 애니메이션 완료 감지
                                path.addEventListener('animationend', function onAnimationEnd() {
                                    path.removeEventListener('animationend', onAnimationEnd);
                                    resolve(animationDuration);
                                }, { once: true });
                                
                                // 타임아웃 안전장치 (애니메이션 시간 + 여유 시간)
                                setTimeout(function() {
                                    resolve(animationDuration);
                                }, animationDuration + 500);
                            } else {
                                // path를 찾을 수 없는 경우
                                resolve(animationDuration);
                            }
                        } else {
                            // 애니메이션이 없는 경우
                            resolve(0);
                        }
                    }, 100);
                })
                .catch(function(error) {
                    // 조용히 폴백 처리 (콘솔 오류 최소화)
                    console.warn('SVG 로드 실패, 이미지로 대체:', error.message);
                    // 실패 시 이미지 태그로 폴백
                    container.innerHTML = '<img src="./images/intro.svg" alt="결혼식에 초대합니다" class="intro-svg svg_handwritng">';
                    resolve(0);
                });
        });
    }

    /**
     * 모든 리소스 로드 완료 확인
     */
    function waitForAllResources() {
        return new Promise(function(resolve) {
            // window.load 이벤트 대기 (모든 리소스 로드 완료)
            if (document.readyState === 'complete') {
                // 이미 로드 완료된 경우
                checkFontsAndImages().then(resolve);
            } else {
                window.addEventListener('load', function() {
                    checkFontsAndImages().then(resolve);
                });
            }
        });
    }
    
    /**
     * 폰트와 이미지 로드 완료 확인
     */
    function checkFontsAndImages() {
        return new Promise(function(resolve) {
            var promises = [];
            
            // 폰트 로드 완료 확인
            if (document.fonts && document.fonts.ready) {
                promises.push(document.fonts.ready);
            }
            
            // 모든 확인이 완료되면 resolve
            if (promises.length > 0) {
                Promise.all(promises).then(function() {
                    // 추가 안정성을 위한 짧은 딜레이
                    setTimeout(resolve, 100);
                });
            } else {
                setTimeout(resolve, 100);
            }
        });
    }
    
    /**
     * 인트로 화면 애니메이션 시작
     */
    async function startIntro() {
        const introScreen = document.getElementById('introScreen');
        if (!introScreen) return;
        
        // SVG 로드 및 설정, 그리기 애니메이션 완료 대기
        await loadAndSetupSVG();
        
        // SVG 그리기 애니메이션이 완료되면 "결혼식에 초대합니다" 문구가 완전히 그려진 상태
        // 애니메이션 완료 후 0.3초 딜레이 후 페이드아웃 시작
        setTimeout(function() {
            fadeOutIntro();
        }, 300); // 0.3초 딜레이
    }
    
    /**
     * 초기화 함수
     */
    function init() {
        // 모든 리소스 로드 완료 후 인트로 애니메이션 시작
        waitForAllResources().then(startIntro);
    }

    // DOM 로드 완료 후 실행
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
    } else {
        init();
    }
})();
    </script>
    
  </body>
</html>
